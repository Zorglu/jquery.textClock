!function(a){a.textClock=function(b,c){defaults={template:"HH:mm:ss",offset:!1,timezone:!1,autosync:!1,cbReady:!1,cbDateTime:!1};var d=this;d.$container=a(b),d.settings={},d.init=function(){d.settings=a.extend({},defaults,c);var b=d.$container.attr("data-format");"undefined"!=typeof b&&(d.settings.format=b);var e=d.$container.attr("data-offset");"undefined"!=typeof e&&(d.settings.offset=e);var f=d.$container.attr("data-timezone");"undefined"!=typeof f&&(d.settings.timezone=f);var g=d.$container.attr("data-autosync");"undefined"!=typeof g&&(d.settings.autosync=g),d.getDate(),d.timer=setInterval(function(){d.run()},1e3),d.settings.autosync&&d.settings.timezone&&(d.timer=setInterval(function(){d.getDate()},6e4*d.settings.autosync)),d.settings.cbReady&&d.settings.cbReady()},d.getDate=function(){var b=function(){d.settings.offset!==!1&&(d.date.setTime(d.date.getTime()+6e4*d.date.getTimezoneOffset()),d.date.setTime(d.date.getTime()+1e3*d.settings.offset))},c=function(b,c){var d="http://json-time.appspot.com/time.json?tz="+b+"&callback=?";a.getJSON(d,function(a){var b=new Date;b.setHours(parseInt(a.hour)),b.setMinutes(parseInt(a.minute)),b.setSeconds(parseInt(a.second)),c&&c(b)})};d.date=new Date,d.settings.timezone?(d.$container.html("---"),c(d.settings.timezone,function(a){d.date=a,d.run()})):(b(),d.run())},d.run=function(){var a=function(a){return a>9?a:"0"+a},b=function(a){return 0===a?a=12:a>12&&(a-=12),a},c=function(a,b){return b?12>a?"AM":"PM":12>a?"am":"pm"};d.date.setTime(d.date.getTime()+1e3);var e=d.settings.format;e=e.replace("HH",a(d.date.getHours())),e=e.replace("H",d.date.getHours()),e=e.replace("hh",a(b(d.date.getHours()))),e=e.replace("h",b(d.date.getHours())),e=e.replace("mm",a(d.date.getMinutes())),e=e.replace("m",d.date.getMinutes()),e=e.replace("ss",a(d.date.getSeconds())),e=e.replace("s",d.date.getSeconds()),e=e.replace("a",c(d.date.getHours(),!1)),e=e.replace("A",c(d.date.getHours(),!0)),d.$container.html(e),d.settings.cbDateTime&&d.settings.cbDateTime(d.date)},d.getTime=function(){return d.date},d.init()},a.fn.textClock=function(b){return this.each(function(){if(void 0===a(this).data("textClock")){var c=new a.textClock(this,b);a(this).data("textClock",c)}})}}(jQuery);